import{a as D}from"./chunk-PRJ5RADF.js";import{d as Y}from"./chunk-OSK3IQRY.js";import"./chunk-JIB744AJ.js";import"./chunk-CTU4KXEC.js";import"./chunk-U4SJQHLU.js";import"./chunk-BH567IKB.js";import"./chunk-OSI5MUBF.js";import"./chunk-YIJ7R3W2.js";import"./chunk-JTFASWY2.js";import"./chunk-S3DWSELF.js";import"./chunk-XWKWQVWO.js";import"./chunk-VCDWO5EX.js";import"./chunk-CEVRVF4S.js";import{b as W}from"./chunk-NZ6F5HKN.js";import"./chunk-VDFKJHPG.js";import"./chunk-22P3VKKG.js";import"./chunk-B6JNIWSP.js";import"./chunk-HZJNBNRE.js";import"./chunk-YB6BI2XV.js";import"./chunk-ZVABKVX7.js";import"./chunk-C7IGGWM4.js";import"./chunk-R5QHB6PJ.js";import"./chunk-TBL6Z3YL.js";import{t as T,w as q}from"./chunk-6355ZLB4.js";import{Ab as S,Ia as J,Ib as s,Ja as b,Kb as m,Oa as l,P as j,Qb as x,Xb as h,Zb as A,_a as L,aa as B,ea as M,eb as V,fa as _,g as U,gb as d,ib as v,kb as P,lb as z,nc as u,o as I,ob as O,pa as N,pb as R,qa as $,qb as r,rb as a,sb as g,wb as G,ya as H,za as k,zb as p}from"./chunk-Y52VWUQN.js";import{a as C,b as w}from"./chunk-MON7YFGF.js";var E=function(t){return t.CREATED="announcement:created",t.SYSTEM_CREATED="announcement:systemCreated",t.JOIN_BULLETIN="announcement:joinBulletin",t.LEAVE_BULLETIN="announcement:leaveBulletin",t}(E||{});var y=function(t){return t.System="system",t.Course="course",t}(y||{});var K=(()=>{let o=class o{constructor(){this.announcement=k.required(),this.selectId=k(void 0),this.selectAnnouncementEvent=H(),this.announcementAvatar=u(()=>this.announcement()&&this.announcement().type==="course"?this.announcement().user.avatar:"/assets/images/og_image.png"),this.announcementAlt=u(()=>this.announcement()&&this.announcement().type==="course"?"\u4F7F\u7528\u8005\u982D\u50CF":"\u7CFB\u7D71\u5716\u793A")}selectAnnouncement(){this.selectAnnouncementEvent.emit(this.announcement())}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=_({type:o,selectors:[["app-bulletin-item"]],inputs:{announcement:[M.SignalBased,"announcement"],selectId:[M.SignalBased,"selectId"]},outputs:{selectAnnouncementEvent:"selectAnnouncementEvent"},standalone:!0,features:[x],decls:9,vars:9,consts:[[1,"flex","cursor-pointer","gap-3","p-4",3,"click"],[1,"h-10","w-10","overflow-hidden","rounded-full"],[1,"h-full","w-full","object-cover",3,"src","alt"],[1,"font-medium","text-tmf-gray-1"],[1,"text-sm","text-tmf-gray-4"]],template:function(i,e){i&1&&(r(0,"div",0),p("click",function(){return e.selectAnnouncement()}),r(1,"div",1),g(2,"img",2),a(),r(3,"div")(4,"h3",3),s(5),a(),r(6,"p",4),s(7),h(8,"date"),a()()()),i&2&&(v("bg-tmf-yellow-1",e.selectId()===e.announcement().id),l(2),d("src",e.announcementAvatar(),b)("alt",e.announcementAlt()),l(3),m(" ",e.announcement().title," "),l(2),m(" ",A(8,6,e.announcement().createdAt,"yyyy/MM/dd")," "))},dependencies:[T]});let t=o;return t})();var X=(t,o)=>o.id;function Z(t,o){if(t&1){let c=G();r(0,"app-bulletin-item",9),p("selectAnnouncementEvent",function(i){N(c);let e=S();return $(e.onSelectAnnouncement(i))}),a()}if(t&2){let c,n=o.$implicit,i=S();d("announcement",n)("selectId",(c=i.selectedAnnouncement())==null?null:c.id)}}function ee(t,o){if(t&1&&(r(0,"div",10)(1,"div",11),s(2),h(3,"date"),a(),r(4,"div",11),s(5),h(6,"date"),a()(),r(7,"div",12)(8,"div",13),g(9,"img",14),a(),r(10,"div",15),g(11,"div",16),a()()),t&2){let c,n,i,e=S();l(2),m(" ",A(3,5,(c=e.selectedAnnouncement())==null?null:c.createdAt,"yyyy/MM/dd")," "),l(3),m(" ",A(6,8,(n=e.selectedAnnouncement())==null?null:n.createdAt,"HH:mm")," "),l(4),d("src",e.selectedAnnouncementAvatar(),b)("alt",e.selectedAnnouncementAlt()),l(2),d("innerHTML",(i=e.selectedAnnouncement())==null?null:i.text,J)}}function te(t,o){t&1&&(r(0,"div",17),s(1," \u5C1A\u672A\u9078\u64C7\u516C\u544A "),a())}var ye=(()=>{let o=class o{constructor(){this.announcementService=B(W),this.webSocketService=B(Y),this.activeTab=L(y.System),this.selectedAnnouncement=L(null),this.systemAnnouncements=D(this.announcementService.apiAnnouncementSystemListGet().pipe(I(n=>n.data.map(i=>w(C({},i),{type:"system"}))))),this.refsh$=new U(void 0),this.courseAnnouncements$=this.refsh$.pipe(j(()=>this.announcementService.apiAnnouncementUserListGet().pipe(I(n=>n.data.map(i=>w(C({},i),{type:"course"})))))),this.courseAnnouncements=D(this.courseAnnouncements$),this.activeAnnouncements=u(()=>this.activeTab()===y.System?this.systemAnnouncements():this.courseAnnouncements()),this.selectedAnnouncementAvatar=u(()=>{let n=this.selectedAnnouncement();return n&&n.type==="course"?n.user.avatar:"/assets/images/og_image.png"}),this.selectedAnnouncementAlt=u(()=>{let n=this.selectedAnnouncement();return n&&n.type==="course"?"\u4F7F\u7528\u8005\u982D\u50CF":"\u7CFB\u7D71\u5716\u793A"})}get Tab(){return y}ngOnInit(){this.webSocketService.onEvent(E.CREATED).subscribe(()=>{this.refsh$.next()}),this.initJoinBULLETIN()}switchTab(n){this.activeTab.set(n),this.selectedAnnouncement.set(null)}onSelectAnnouncement(n){this.selectedAnnouncement.set(n)}initJoinBULLETIN(){this.webSocketService.emit(E.JOIN_BULLETIN,"")}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=_({type:o,selectors:[["app-bulletin-page"]],standalone:!0,features:[x],decls:16,vars:11,consts:[[1,"mx-auto","h-[900px]","w-full","p-10","py-[50px]","lg:max-w-[1200px]"],[1,"mb-6","text-2xl","text-tmf-gray-1"],[1,"flex","h-full","gap-6"],[1,"w-[300px]","rounded-lg","border","border-tmf-gray-6","bg-white","overflow-y-auto"],[1,"flex","border-b","border-tmf-gray-6"],[1,"flex-1","cursor-pointer","py-3","text-center","font-medium",3,"click"],[1,"divide-y","divide-tmf-gray-6"],[3,"announcement","selectId"],[1,"flex-1","rounded-lg","border","border-tmf-gray-6","bg-white","p-6"],[3,"selectAnnouncementEvent","announcement","selectId"],[1,"mb-4","flex","items-center","justify-between"],[1,"text-sm","text-tmf-gray-4"],[1,"flex","gap-4"],[1,"h-10","w-10","overflow-hidden","rounded-full","bg-tmf-gray-6"],[1,"h-full","w-full","object-cover",3,"src","alt"],[1,"flex-1","rounded-2xl","border","border-tmf-gray-6","p-6"],[1,"whitespace-pre-line","text-tmf-gray-2",3,"innerHTML"],[1,"flex","h-full","flex-grow","items-center","justify-center","text-tmf-gray-3"]],template:function(i,e){if(i&1&&(r(0,"div",0)(1,"h1",1),s(2,"\u516C\u544A"),a(),r(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),p("click",function(){return e.switchTab(e.Tab.System)}),s(7),a(),r(8,"div",5),p("click",function(){return e.switchTab(e.Tab.Course)}),s(9),a()(),r(10,"div",6),O(11,Z,1,2,"app-bulletin-item",7,X),a()(),r(13,"div",8),V(14,ee,12,11)(15,te,2,0),a()()()),i&2){let f,F;l(6),P(e.activeTab()==="system"?"border-b-2 border-tmf-orange-1":""),v("text-tmf-gray-4",e.activeTab()!==e.Tab.System),l(),m(" \u7CFB\u7D71\u516C\u544A (",(f=e.systemAnnouncements())==null?null:f.length,") "),l(),P(e.activeTab()===e.Tab.Course?"border-b-2 border-tmf-orange-1":""),v("text-tmf-gray-4",e.activeTab()!==e.Tab.Course),l(),m(" \u8AB2\u7A0B\u516C\u544A (",(F=e.courseAnnouncements())==null?null:F.length,") "),l(2),R(e.activeAnnouncements()),l(3),z(14,e.selectedAnnouncement()?14:15)}},dependencies:[q,T,K]});let t=o;return t})();export{ye as default};
