import{d as _t}from"./chunk-YNN4KD6K.js";import"./chunk-ATI53E2T.js";import"./chunk-NEZFXIY3.js";import"./chunk-U4SJQHLU.js";import"./chunk-VNGFKULG.js";import"./chunk-MEU3TBTC.js";import"./chunk-JEUZITVV.js";import{c as V}from"./chunk-S4XAHOAC.js";import"./chunk-MD6RTHOX.js";import{c as dt,d as ut,e as ht}from"./chunk-2OK5Q4JC.js";import{a as Ct}from"./chunk-PAB5CEVZ.js";import{a as st,d as lt}from"./chunk-VYDWENZN.js";import{b as B,d as gt}from"./chunk-H32CEN7X.js";import"./chunk-NQN2KDIR.js";import"./chunk-K3BFTGYZ.js";import"./chunk-4LOOS5GN.js";import{a as mt,b as pt}from"./chunk-L6R3LD7U.js";import"./chunk-5YWPRN7E.js";import{a as it,b as ot,c as L,e as E,f as D,g as at,i as rt,k as ct,l as H,o as N,q as U,s as v}from"./chunk-I5MD2NP3.js";import"./chunk-2X4GIXVK.js";import"./chunk-MBKEEROQ.js";import"./chunk-XCFTMZOW.js";import"./chunk-SZHRPNOM.js";import{l as F,t as nt,v as O}from"./chunk-T2423WEX.js";import{Aa as Y,Ba as q,C as J,G as Q,Hb as l,Ia as y,Ib as M,Ja as z,Jb as Z,Ma as W,Oa as s,Ob as K,Pb as b,V as X,Wb as tt,Yb as et,aa as g,eb as d,fa as f,gb as m,ib as $,kb as C,mb as S,nb as T,ob as I,pa as P,pb as i,qa as w,qb as o,rb as u,vb as A,yb as p,zb as h}from"./chunk-VREVKPXB.js";import"./chunk-MON7YFGF.js";var G=function(t){return t.CHAT="chat",t.ANNOUNCEMENT="announcement",t}(G||{});function Pt(t,e){t&1&&(i(0,"span",3),l(1," sms "),o())}function wt(t,e){t&1&&(i(0,"span",3),l(1," person_add "),o())}function yt(t,e){if(t&1){let a=A();i(0,"li",6),p("click",function(){let r=P(a).$implicit,c=h(2);return w(c.selectOption(r))}),i(1,"div",7)(2,"p"),l(3),o(),d(4,Pt,2,0,"span",3)(5,wt,2,0),o()()}if(t&2){let a=e.$implicit;s(3),M(a.name),s(),C(4,a.joined?4:5)}}function Et(t,e){if(t&1&&(i(0,"ul",4),d(1,yt,6,2,"li",5),o()),t&2){let a=h();s(),m("ngForOf",a.options)}}var Mt=(()=>{let e=class e{constructor(){this.elementRef=g(Y),this.options=[],this.searchEvent=new q,this.selectEvent=new q,this.control=new at,this.isOpen=!1,this.onChange=n=>{},this.onTouched=()=>{}}clickout(n){setTimeout(()=>{this.elementRef.nativeElement.contains(n.target)||(this.isOpen=!1)})}ngOnInit(){this.control.valueChanges.pipe(J(200),Q()).subscribe(n=>{this.onChange(n)})}search(){this.searchEvent.emit(this.control.value)}selectOption(n){this.selectEvent.emit(n),this.isOpen=!1}writeValue(n){n!==this.control.value&&this.control.setValue(n)}registerOnChange(n){this.onChange=n}registerOnTouched(n){this.onTouched=n}setDisabledState(n){}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=f({type:e,selectors:[["app-search-input"]],hostBindings:function(r,c){r&1&&p("click",function(x){return c.clickout(x)},!1,W)},inputs:{options:"options"},outputs:{searchEvent:"searchEvent",selectEvent:"selectEvent"},standalone:!0,features:[K([{provide:it,useExisting:X(()=>e),multi:!0}]),b],decls:6,vars:2,consts:[[1,"relative","flex","w-full","items-center","border"],["type","text","placeholder","\u641C\u5C0B",1,"flex-grow","p-3","pr-0","outline-none","min-w-0",3,"focus","formControl"],[1,"flex","cursor-pointer","items-center","justify-center","bg-tmf-gray-2","p-3","text-white","duration-100","hover:bg-tmf-gray-1",3,"click"],[1,"material-symbols-outlined"],[1,"absolute","top-full","w-full","rounded-sm","border","bg-white","shadow-md","z-10"],["class","cursor-pointer border-b p-3 hover:bg-tmf-gray-6",3,"click",4,"ngFor","ngForOf"],[1,"cursor-pointer","border-b","p-3","hover:bg-tmf-gray-6",3,"click"],[1,"flex","items-center","justify-between"]],template:function(r,c){r&1&&(i(0,"div",0)(1,"input",1),p("focus",function(){return c.isOpen=!0}),o(),i(2,"div",2),p("click",function(){return c.search()}),i(3,"span",3),l(4," search "),o()(),d(5,Et,2,1,"ul",4),o()),r&2&&(s(),m("formControl",c.control),s(4),C(5,c.options&&c.options.length&&c.isOpen?5:-1))},dependencies:[O,F,v,ot,E,ct],styles:["[_nghost-%COMP%]{display:block}"]});let t=e;return t})();var k=function(t){return t.MESSAGE_RECEIVED="chat:messageReceived",t.READ_STATUS_UPDATED="chat:readStatusUpdated",t.CHAT_LIST_UPDATED="chat:chatListUpdated",t}(k||{}),R=function(t){return t.JOIN_ROOM="joinRoom",t.LEAVE_ROOM="leaveRoom",t}(R||{});function St(t,e){if(t&1&&u(0,"img",10),t&2){let a=h().$implicit;m("src",a.user.avatar,z)}}function Tt(t,e){t&1&&u(0,"div",15)}function It(t,e){if(t&1&&(i(0,"div",14)(1,"p"),l(2),o()()),t&2){let a=h().$implicit;s(2),M(a.unreadCount)}}function At(t,e){if(t&1){let a=A();i(0,"li",7),p("click",function(){let r=P(a).$implicit,c=h();return w(c.selectChat(r))}),i(1,"div",8)(2,"div",9),d(3,St,1,1,"img",10)(4,Tt,1,0),o(),i(5,"div",11)(6,"p",12),l(7),o(),u(8,"p",13),o(),d(9,It,3,1,"div",14),o()()}if(t&2){let a=e.$implicit;s(3),C(3,a.user.avatar?3:4),s(4),M(a.user.name),s(),m("innerHTML",a.latestMessage?a.latestMessage.text:"",y),s(),C(9,a.unreadCount?9:-1)}}function Lt(t,e){t&1&&(i(0,"div",6)(1,"p"),l(2,"\u5C1A\u672A\u9078\u64C7\u804A\u5929\u5BA4"),o()())}function kt(t,e){if(t&1&&u(0,"img",10),t&2){let a=h(2);m("src",a.currentChat.user.avatar,z)}}function Rt(t,e){t&1&&u(0,"div",15)}function Ft(t,e){t&1&&(i(0,"div",18)(1,"p"),l(2,"\u5C1A\u672A\u6709\u8A0A\u606F"),o()())}function Dt(t,e){t&1&&(i(0,"p",25),l(1,"\u5DF2\u8B80"),o())}function Ht(t,e){if(t&1&&(i(0,"div",23),u(1,"p",24),d(2,Dt,2,0,"p",25),o()),t&2){let a=h().$implicit;s(),m("innerHTML",a.text,y),s(),C(2,a.readBy.includes(a.receiverId)?2:-1)}}function Nt(t,e){if(t&1&&(i(0,"div",26),u(1,"p",24),o()),t&2){let a=h().$implicit;s(),m("innerHTML",a.text,y)}}function Ut(t,e){if(t&1&&d(0,Ht,3,2,"div",23)(1,Nt,2,1),t&2){let a=e.$implicit,n=h(3);C(0,a.senderId===n.userInfo.id?0:1)}}function Vt(t,e){if(t&1&&(i(0,"div",22),T(1,Ut,2,1,null,null,S),o()),t&2){let a=h(2);s(),I(a.currentMessages)}}function Bt(t,e){if(t&1){let a=A();i(0,"div",16)(1,"div",9),d(2,kt,1,1,"img",10)(3,Rt,1,0),o(),i(4,"div",17),l(5),o()(),i(6,"div",11),d(7,Ft,3,0,"div",18)(8,Vt,3,0),o(),i(9,"div",19)(10,"tmf-quill-editor",20),p("contentChangeEvent",function(r){P(a);let c=h();return w(c.contentChange(r))}),o(),i(11,"button",21),p("click",function(){P(a);let r=h();return w(r.sendMessage())}),l(12,"\u9001\u51FA"),o()()}if(t&2){let a=h();s(2),C(2,a.currentChat.user.avatar?2:3),s(3),M(a.currentChat.user.name),s(2),C(7,a.currentMessages.length===0||!a.currentMessages||!a.userInfo?7:8),s(3),m("height","150px")}}var Ot=(()=>{let e=class e{constructor(){this.fb=g(U),this.chatService=g(gt),this.websocketService=g(_t),this.userInfo=null,this.chatForm=this.fb.group({message:this.fb.control(null),search:this.fb.control(null)}),this.chatUsers=[],this.chatList=[],this.currentChat=null,this.currentMessages=[]}ngOnInit(){this.getUserList(),this.getChatList(),this.initBindEvent()}ngOnDestroy(){this.currentChat&&this.websocketService.emit(R.LEAVE_ROOM,this.currentChat?.id)}initBindEvent(){this.websocketService.onEvent(k.MESSAGE_RECEIVED).subscribe(n=>{console.log("MESSAGE_RECEIVED",n)}),this.websocketService.onEvent(k.READ_STATUS_UPDATED).subscribe(()=>{this.currentChat&&this.getMessageList(this.currentChat.id)}),this.websocketService.onEvent(k.CHAT_LIST_UPDATED).subscribe(n=>{console.log("CHAT_LIST_UPDATED",n)})}sendMessage(){this.currentChat&&this.chatService.apiChatMessagePost({chatSendMesssageRequestModel:{chatId:this.currentChat.id,receiverId:this.currentChat.user.id,text:this.chatForm.controls.message.value||"",type:"general"}}).subscribe(()=>{this.chatForm.controls.message.setValue(null)})}getUserList(n){this.chatService.apiChatUsersGet({name:n||""}).subscribe(r=>{this.chatUsers=r.data})}getChatList(){this.chatService.apiChatListGet().subscribe(n=>{this.chatList=n.data})}getMessageList(n){this.chatService.apiChatChatIdMessagesGet({chatId:n}).subscribe(r=>{this.currentMessages=r.data})}selectUser(n){if(n.joined){let r=this.chatList.find(c=>c.user.id===n.id);r&&this.selectChat(r)}else this.chatService.apiChatCreatePost({requestBody:[n.id,this.userInfo.id]}).subscribe(()=>{this.getChatList()})}selectChat(n){this.websocketService.emit(R.LEAVE_ROOM,this.currentChat?.id),this.currentChat=n,this.websocketService.emit(R.JOIN_ROOM,n.id),this.getMessageList(n.id)}contentChange(n){this.chatForm.controls.message.setValue(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=f({type:e,selectors:[["app-chat"]],inputs:{userInfo:"userInfo"},standalone:!0,features:[b],decls:9,vars:3,consts:[[1,"chat",3,"formGroup"],[1,"chatListContainer"],["formControlName","search",3,"searchEvent","selectEvent","options"],[1,"chatList"],[1,"chatItem"],[1,"chatRoom"],[1,"emptyChat"],[1,"chatItem",3,"click"],[1,"flex","items-center","pr-[50px]"],[1,"avator"],["alt","avatar",1,"h-10","w-10","rounded-full",3,"src"],[1,"chatContent"],[1,"chatName"],[1,"chatMessage",3,"innerHTML"],[1,"unreadCount"],[1,"h-10","w-10","rounded-full","bg-gray-300"],[1,"chatHeader"],[1,"userName"],[1,"emptyMessage"],[1,"chatInput"],[3,"contentChangeEvent","height"],[1,"sendButton",3,"click"],[1,"messages"],[1,"message","message-right"],[3,"innerHTML"],[1,"messageOnRead"],[1,"message","message-left"]],template:function(r,c){r&1&&(i(0,"div",0)(1,"div",1)(2,"app-search-input",2),p("searchEvent",function(x){return c.getUserList(x)})("selectEvent",function(x){return c.selectUser(x)}),o(),i(3,"ul",3),T(4,At,10,4,"li",4,S),o()(),i(6,"div",5),d(7,Lt,3,0,"div",6)(8,Bt,13,4),o()()),r&2&&(m("formGroup",c.chatForm),s(2),m("options",c.chatUsers),s(2),I(c.chatList),s(3),C(7,c.currentChat?8:7))},dependencies:[v,E,D,H,N,Mt,V],styles:['[_nghost-%COMP%]{display:block;overflow:auto}.chat[_ngcontent-%COMP%]{display:flex;height:800px;width:100%;min-width:768px}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]{display:flex;width:250px;flex-shrink:0;flex-direction:column}@media (min-width: 768px){.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]{width:400px}}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto;border-width:1px;border-top-width:0px}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]{position:relative;display:flex;cursor:pointer;align-items:center;border-bottom-width:1px;padding:.5rem}@media (min-width: 768px){.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]{padding:.75rem}}@media (min-width: 1024px){.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]{padding:1rem}}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]:hover{background-color:#e9e9e9b3}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]:active{--tw-bg-opacity: 1;background-color:rgb(233 233 233 / var(--tw-bg-opacity))}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{height:3rem;width:3rem;border-radius:9999px}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]{margin-left:1rem}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .chatName[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:600;--tw-text-opacity: 1;color:rgb(29 29 29 / var(--tw-text-opacity))}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .chatMessage[_ngcontent-%COMP%]{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(102 102 102 / var(--tw-text-opacity))}@media (min-width: 768px){.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .chatMessage[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem}}.chat[_ngcontent-%COMP%]   .chatListContainer[_ngcontent-%COMP%]   .chatList[_ngcontent-%COMP%]   .chatItem[_ngcontent-%COMP%]   .unreadCount[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));border-radius:9999px;--tw-bg-opacity: 1;background-color:rgb(243 105 35 / var(--tw-bg-opacity));padding:.25rem .5rem;font-size:.75rem;line-height:1rem;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]{display:flex;height:100%;flex-grow:1;flex-direction:column;border-width:1px;border-left-width:0px}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .emptyChat[_ngcontent-%COMP%]{display:flex;flex-grow:1;align-items:center;justify-content:center;--tw-text-opacity: 1;color:rgb(102 102 102 / var(--tw-text-opacity))}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatHeader[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:.75rem;border-bottom-width:1px;padding:.75rem}@media (min-width: 768px){.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatHeader[_ngcontent-%COMP%]{gap:1.25rem;padding:1rem}}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatHeader[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:600;--tw-text-opacity: 1;color:rgb(29 29 29 / var(--tw-text-opacity))}@media (min-width: 768px){.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatHeader[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem}}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatHeader[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{height:2.5rem;width:2.5rem;border-radius:9999px}@media (min-width: 768px){.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatHeader[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{height:3rem;width:3rem}}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]{display:flex;flex-grow:1;flex-direction:column;overflow-y:auto;border-bottom-width:1px;padding:1rem}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .emptyMessage[_ngcontent-%COMP%]{display:flex;flex-grow:1;align-items:center;justify-content:center;--tw-text-opacity: 1;color:rgb(102 102 102 / var(--tw-text-opacity))}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{position:relative;height:fit-content;width:40%;overflow-wrap:break-word;border-radius:.5rem;padding:10px 15px;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(51 51 51 / var(--tw-text-opacity))}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message.message-left[_ngcontent-%COMP%]{align-self:flex-start;--tw-bg-opacity: 1;background-color:rgb(212 212 212 / var(--tw-bg-opacity))}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message.message-left[_ngcontent-%COMP%]:after{position:absolute;bottom:10px;left:-8px;margin-top:-5px;height:0px;width:0px;border-width:10px;border-left-width:0px;border-color:transparent;--tw-border-opacity: 1;border-right-color:rgb(212 212 212 / var(--tw-border-opacity));--tw-content: "";content:var(--tw-content)}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message.message-left[_ngcontent-%COMP%]   .messageOnRead[_ngcontent-%COMP%]{position:absolute;bottom:10px;right:100%}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message.message-right[_ngcontent-%COMP%]{align-self:flex-end;--tw-bg-opacity: 1;background-color:rgb(243 105 35 / var(--tw-bg-opacity))}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message.message-right[_ngcontent-%COMP%]:after{position:absolute;bottom:10px;right:-8px;margin-top:-5px;height:0px;width:0px;border-width:10px;border-right-width:0px;border-color:transparent;--tw-border-opacity: 1;border-left-color:rgb(243 105 35 / var(--tw-border-opacity));--tw-content: "";content:var(--tw-content)}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatContent[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message.message-right[_ngcontent-%COMP%]   .messageOnRead[_ngcontent-%COMP%]{position:absolute;bottom:10px;white-space:nowrap;font-size:12px;--tw-text-opacity: 1;color:rgb(102 102 102 / var(--tw-text-opacity));right:calc(100% + 5px)}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatInput[_ngcontent-%COMP%]{display:grid;width:100%;grid-template-columns:repeat(1,minmax(0,1fr));gap:.75rem;padding:1rem}.chat[_ngcontent-%COMP%]   .chatRoom[_ngcontent-%COMP%]   .chatInput[_ngcontent-%COMP%]   .sendButton[_ngcontent-%COMP%]{display:flex;width:100px;cursor:pointer;align-items:center;justify-content:center;justify-self:end;border-radius:.375rem;--tw-bg-opacity: 1;background-color:rgb(243 105 35 / var(--tw-bg-opacity));padding-top:.25rem;padding-bottom:.25rem;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}']});let t=e;return t})();function Gt(t,e){if(t&1&&u(0,"tmf-option",12),t&2){let a=e.$implicit;m("value",a.value)("label",a.label)}}function jt(t,e){if(t&1&&u(0,"tmf-option",12),t&2){let a=e.$implicit;m("value",a.value)("label",a.label)}}var vt=(()=>{let e=class e{constructor(){this.fb=g(U),this.announcementService=g(B),this.dialogRef=g(dt),this.dialogData=g(ut),this.announcementForm=this.fb.group({title:this.fb.control(null,[L.required]),text:this.fb.control(null,[L.required]),courseIds:this.fb.control(null,[L.required]),target:this.fb.control(null,[L.required])}),this.InputType=st}get targetOptions(){return this.dialogData.targetOptions||[]}get courseOptions(){return this.dialogData.courseOptions||[]}contentChange(n){this.announcementForm.controls.text.setValue(n)}submit(){this.announcementForm.invalid}cancel(){this.dialogRef.close()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=f({type:e,selectors:[["app-create-announcement-dialog"]],standalone:!0,features:[b],decls:16,vars:12,consts:[[1,"w-[350px]","bg-white","p-5","md:w-[600px]"],[1,"flex","justify-center","py-3"],[1,"text-lg","font-semibold"],[3,"formGroup"],["label","\u6A19\u984C","formControlName","title",3,"inputType","isRequired"],["label","\u767C\u4F48\u5C0D\u8C61","formControlName","target",1,"mb-6",3,"isRequired","multiSelect"],[3,"value","label",4,"ngFor","ngForOf"],["label","\u767C\u4F48\u8AB2\u7A0B","formControlName","courseIds",1,"mb-6",3,"isRequired","multiSelect"],["label","\u5167\u6587",1,"mb-6",3,"contentChangeEvent","isRequired","height"],[1,"flex","justify-center","gap-5"],["type","button",1,"w-[100px]","rounded-md","bg-tmf-orange-1","py-1","text-sm","text-white","disabled:opacity-50","cursor-not-allowed",3,"click","disabled"],["type","button",1,"w-[100px]","rounded-md","border","py-1","text-tmf-gray-2",3,"click"],[3,"value","label"]],template:function(r,c){r&1&&(i(0,"div",0)(1,"div",1)(2,"p",2),l(3,"\u65B0\u589E\u516C\u544A"),o()(),i(4,"form",3),u(5,"tmf-input",4),i(6,"tmf-select",5),d(7,Gt,1,2,"tmf-option",6),o(),i(8,"tmf-select",7),d(9,jt,1,2,"tmf-option",6),o(),i(10,"tmf-quill-editor",8),p("contentChangeEvent",function(x){return c.contentChange(x)}),o(),i(11,"div",9)(12,"button",10),p("click",function(){return c.submit()}),l(13," \u78BA\u8A8D "),o(),i(14,"button",11),p("click",function(){return c.cancel()}),l(15," \u53D6\u6D88 "),o()()()()),r&2&&(s(4),m("formGroup",c.announcementForm),s(),m("inputType",c.InputType.Outline)("isRequired",!0),s(),m("isRequired",!0)("multiSelect",!1),s(),m("ngForOf",c.targetOptions),s(),m("isRequired",!0)("multiSelect",!0),s(),m("ngForOf",c.courseOptions),s(),m("isRequired",!0)("height","150px"),s(2),m("disabled",c.announcementForm.invalid))},dependencies:[O,F,v,rt,E,D,H,N,lt,pt,mt,V],styles:["[_nghost-%COMP%]{display:block}"]});let t=e;return t})();function qt(t,e){if(t&1&&(i(0,"tr")(1,"td",6),l(2),o(),i(3,"td",6),l(4),o(),i(5,"td",6),l(6),tt(7,"date"),o(),i(8,"td"),u(9,"div",7),o()()),t&2){let a=e.$implicit;s(2),M(a.title),s(2),M(a.target),s(2),Z(" ",et(7,4,a.createdAt,"yyyy/MM/dd HH:MM")," "),s(3),m("innerHTML",a.text,y)}}function zt(t,e){t&1&&(i(0,"tr",5)(1,"td",8),l(2,"\u5C1A\u7121\u516C\u544A"),o()())}var xt=(()=>{let e=class e{constructor(){this.dialog=g(ht),this.announcementService=g(B),this.courseOptions=[],this.targetOptions=[],this.announcementList=[]}ngOnInit(){this.initOptions(),this.getList()}initOptions(){this.announcementService.apiAnnouncementInitGet().subscribe(n=>{this.courseOptions=n.data.courseOptions.map(r=>({label:r.label,value:r.value})),this.targetOptions=n.data.targetOptions.map(r=>({label:r.label||"",value:r.value}))})}getList(){this.announcementService.apiAnnouncementListGet().subscribe(n=>{this.announcementList=n.data})}create(){this.dialog.open(vt,{data:{courseOptions:this.courseOptions,targetOptions:this.targetOptions}}).closed.subscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=f({type:e,selectors:[["app-announcement"]],standalone:!0,features:[b],decls:21,vars:1,consts:[[1,"announcement"],[1,"mb-5","flex","items-center","justify-end","flex-shrink-0"],[1,"flex","w-fit","items-center","gap-1","whitespace-nowrap","rounded-md","bg-tmf-orange-1","p-2","text-white",3,"click"],[1,"material-symbols-outlined"],[1,"announcementTable"],[1,"h-full"],[1,"text-center"],[3,"innerHTML"],["colspan","4",1,"text-center","h-full"]],template:function(r,c){r&1&&(i(0,"div",0)(1,"div",1)(2,"button",2),p("click",function(){return c.create()}),i(3,"span",3),l(4," add "),o(),l(5," \u767C\u4F48\u65B0\u516C\u544A "),o()(),i(6,"table",4)(7,"thead")(8,"tr")(9,"th"),l(10,"\u6A19\u984C"),o(),i(11,"th"),l(12,"\u767C\u4F48\u5C0D\u8C61"),o(),i(13,"th"),l(14,"\u767C\u4F48\u6642\u9593"),o(),i(15,"th"),l(16,"\u5167\u6587"),o()()(),i(17,"tbody"),T(18,qt,10,7,"tr",null,S,!1,zt,3,0,"tr",5),o()()()),r&2&&(s(18),I(c.announcementList))},dependencies:[O,nt,v],styles:["[_nghost-%COMP%]{display:block;overflow:auto}.announcement[_ngcontent-%COMP%]{display:flex;height:800px;width:100%;min-width:768px;flex-direction:column;border-width:1px;padding:1.25rem}.announcement[_ngcontent-%COMP%]   .announcementTable[_ngcontent-%COMP%]{width:100%;flex-grow:1}.announcement[_ngcontent-%COMP%]   .announcementTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{border-width:1px;--tw-border-opacity: 1;border-color:rgb(243 105 35 / var(--tw-border-opacity))}.announcement[_ngcontent-%COMP%]   .announcementTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(243 105 35 / var(--tw-bg-opacity))}.announcement[_ngcontent-%COMP%]   .announcementTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-right-width:1px;padding:.5rem;font-size:1.125rem;line-height:1.75rem;font-weight:600;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.announcement[_ngcontent-%COMP%]   .announcementTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-right-width:0px}.announcement[_ngcontent-%COMP%]   .announcementTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{border-width:1px}.announcement[_ngcontent-%COMP%]   .announcementTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom-width:1px}.announcement[_ngcontent-%COMP%]   .announcementTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-right-width:1px;padding:.5rem}.announcement[_ngcontent-%COMP%]   .announcementTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right-width:0px}"]});let t=e;return t})();function $t(t,e){if(t&1&&u(0,"app-chat",3),t&2){let a=h();m("userInfo",a.userInfo)}}function Jt(t,e){t&1&&u(0,"app-announcement")}var Ue=(()=>{let e=class e{constructor(){this.userInfoService=g(Ct),this.userInfo=null,this.tab=G.CHAT,this.Tab=G}ngOnInit(){this.userInfoService.userInfo$.subscribe(n=>{this.userInfo=n})}changeTab(n){this.tab=n}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=f({type:e,selectors:[["app-message"]],standalone:!0,features:[b],decls:10,vars:5,consts:[[1,"mx-auto","w-full","py-[50px]","p-10","lg:max-w-[1200px]"],[1,"tabList"],[1,"tabItem",3,"click"],[3,"userInfo"]],template:function(r,c){r&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),p("click",function(){return c.changeTab(c.Tab.CHAT)}),i(3,"p"),l(4,"\u500B\u4EBA\u8A0A\u606F"),o()(),i(5,"div",2),p("click",function(){return c.changeTab(c.Tab.ANNOUNCEMENT)}),i(6,"p"),l(7,"\u516C\u544A\u8A0A\u606F"),o()()(),d(8,$t,1,1,"app-chat",3)(9,Jt,1,0),o()),r&2&&(s(2),$("active",c.tab===c.Tab.CHAT),s(3),$("active",c.tab===c.Tab.ANNOUNCEMENT),s(3),C(8,c.tab===c.Tab.CHAT?8:9))},dependencies:[O,Ot,xt],styles:["[_nghost-%COMP%]{display:block}.tabList[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;border-radius:.125rem;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}@media (min-width: 768px){.tabList[_ngcontent-%COMP%]{width:400px}}.tabList[_ngcontent-%COMP%]   .tabItem[_ngcontent-%COMP%]{display:flex;flex-grow:1;cursor:pointer;justify-content:center;border-top-width:1px;padding:1rem}.tabList[_ngcontent-%COMP%]   .tabItem[_ngcontent-%COMP%]:first-child{border-top-left-radius:.125rem;border-bottom-left-radius:.125rem;border-left-width:1px}.tabList[_ngcontent-%COMP%]   .tabItem[_ngcontent-%COMP%]:last-child{border-top-right-radius:.125rem;border-bottom-right-radius:.125rem;border-right-width:1px}.tabList[_ngcontent-%COMP%]   .tabItem.active[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(243 105 35 / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}"]});let t=e;return t})();export{Ue as default};
