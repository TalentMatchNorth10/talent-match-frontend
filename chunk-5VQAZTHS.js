import{a as T,b as C,c as M,d as D}from"./chunk-BLADEW7G.js";import{a as S}from"./chunk-W2P5HSG5.js";import"./chunk-SZHRPNOM.js";import{w as y}from"./chunk-RQGDFRRU.js";import{Hb as w,Oa as r,Pb as x,aa as u,eb as p,fa as m,gb as h,kb as f,pb as s,qb as d,rb as v,zb as g}from"./chunk-VREVKPXB.js";import"./chunk-MON7YFGF.js";function O(a,i){if(a&1&&(s(0,"div",1),v(1,"full-calendar",2),d()),a&2){let E=g();r(),h("options",E.calendarOptions)}}var j=(()=>{let i=class i{constructor(){this.studentService=u(S)}ngOnInit(){this.calendarOptions={initialView:"dayGridMonth",plugins:[M,D],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek"},locale:"zh-tw",showNonCurrentDates:!0,weekends:!0,selectable:!0,allDaySlot:!1,eventContent:function(e){let[t]=e.event.title.split(" "),n=e.event.start?.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),o=e.event.end?.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});return{html:`
              <div style="display: flex; flex-direction: column;">
                <p class="">${n} - ${o}</p>
                <div style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${t}</div>
              </div>
            `}},dayMaxEventRows:!0,dayMaxEvents:2,views:{timeGrid:{dayMaxEventRows:1,dayMaxEvents:1}},moreLinkContent:function(e){return"+"+e.num+" \u7B46\u9810\u7D04"},windowResize:({view:e})=>{window.innerWidth<=1024&&e.calendar.changeView("dayGridMonth"),this.handleWindowResize(e)},datesSet:({view:e})=>{let t=e.calendar.getDate().toLocaleDateString().split("/").join("-").slice(0,6);this.handleDatesSet(t)}}}getHeaderToolbar(){return window.innerWidth<=1024?{left:"dayGridMonth",center:"title",right:"prev,next"}:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek"}}handleWindowResize(e){this.calendarOptions.headerToolbar=this.getHeaderToolbar()}handleDatesSet(e){this.studentService.apiStudentCalendarGet({date:e}).subscribe(t=>{let n=this.transformDataToEvents(t.data);this.calendarOptions.events=n})}transformDataToEvents(e){let t=[];return e.calendar.forEach(n=>{let{reserve_time:o,course_name:G,student_name:W}=n,[l,b]=o.split("T"),c=`${l}T${b.slice(0,5)}`,$=`${l}T${this.calculateEndTime(c)}`;t.push({title:G,start:c,end:$})}),t}calculateEndTime(e){let t=new Date(e);return t.setHours(t.getHours()+1),t.toLocaleTimeString("en-US",{hour12:!1}).slice(0,5)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=m({type:i,selectors:[["app-student-calendar-page"]],standalone:!0,features:[x],decls:3,vars:1,consts:[[1,"text-[22px]","md:text-[26px]","lg:text-[30px]","font-bold","leading-9","mb-5"],[1,"p-5"],[3,"options"]],template:function(t,n){t&1&&(s(0,"h1",0),w(1,"\u884C\u4E8B\u66C6"),d(),p(2,O,2,1,"div",1)),t&2&&(r(2),f(2,n.calendarOptions?2:-1))},dependencies:[y,C,T]});let a=i;return a})();export{j as default};
