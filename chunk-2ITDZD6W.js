import{a as fe,b as he,c as ge}from"./chunk-6MVSTDUL.js";import{a as Ce}from"./chunk-H5BVPWUM.js";import{a as ae}from"./chunk-JNREB3ER.js";import"./chunk-OSK3IQRY.js";import"./chunk-JIB744AJ.js";import"./chunk-CTU4KXEC.js";import"./chunk-U4SJQHLU.js";import"./chunk-BH567IKB.js";import"./chunk-OSI5MUBF.js";import"./chunk-YIJ7R3W2.js";import{c as se,d as pe}from"./chunk-JTFASWY2.js";import"./chunk-S3DWSELF.js";import"./chunk-XWKWQVWO.js";import"./chunk-VCDWO5EX.js";import{a as oe,d as re}from"./chunk-CEVRVF4S.js";import{n as me,q as de,r as _e}from"./chunk-NZ6F5HKN.js";import"./chunk-VDFKJHPG.js";import"./chunk-22P3VKKG.js";import"./chunk-B6JNIWSP.js";import{a as le,b as ce}from"./chunk-WNFPW4WH.js";import"./chunk-HZJNBNRE.js";import"./chunk-YB6BI2XV.js";import"./chunk-ZVABKVX7.js";import{c as w,e as J,f as H,k as K,l as X,m as Z,n as ee,o as te,q as ie,s as ne}from"./chunk-C7IGGWM4.js";import{a as ue}from"./chunk-R5QHB6PJ.js";import"./chunk-TBL6Z3YL.js";import{k as U,l as Y,w as z}from"./chunk-6355ZLB4.js";import{A as G,Ab as m,Hb as k,Ib as _,Jb as L,Kb as M,Oa as a,P as E,Qb as Q,S as W,Sb as N,aa as F,eb as h,fa as j,gb as r,i as $,ib as S,lb as T,nb as I,ob as O,pa as C,pb as V,qa as x,qb as s,rb as u,sb as g,tb as P,u as B,ub as D,wb as y,y as R,zb as b}from"./chunk-Y52VWUQN.js";import{a as A,b as q}from"./chunk-MON7YFGF.js";var p=function(n){return n.All="all",n.Info="info",n.Work_experience="work_experience",n.Learning_experience="learning_experience",n.Teaching_certificate="teaching_certificate",n.Video="video",n}(p||{});var xe=n=>({"!cursor-not-allowed !text-tmf-gray-2":n});function be(n,c){if(n&1){let i=y();s(0,"button",11),b("click",function(e){C(i);let t=m().$implicit;return m().changeMode(t,!1),x(e.stopPropagation())}),_(1," \u53D6\u6D88 "),u(),s(2,"button",12),b("click",function(e){C(i);let t=m().$implicit;return m().save(t),x(e.stopPropagation())}),_(3," \u5132\u5B58 "),u()}}function ve(n,c){if(n&1){let i=y();s(0,"button",13),b("click",function(e){C(i);let t=m().$implicit;return m().changeMode(t,!0),x(e.stopPropagation())}),s(1,"span",14),_(2," edit_square "),u(),_(3," \u7DE8\u8F2F "),u()}}function ye(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function Fe(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit,o=m(3);S("selected",o.topicControl.value==null?null:o.topicControl.value.includes(i.value)),r("value",i.value)("label",i.main_category)}}function Te(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit,o=m().$implicit;S("selected",o.controls.sub_categories.value==null?null:o.controls.sub_categories.value.includes(i)),r("value",i)("label",i)}}function we(n,c){if(n&1&&(P(0),s(1,"tmf-select",25),h(2,Te,1,4,"tmf-option",18),u(),D()),n&2){let i=c.$implicit,o=m(3);a(),r("label",o.getCategoryLabel(i.controls.category_id.value))("multiSelect",!0)("maxSelected",3)("isRequired",!0)("formControl",i.controls.sub_categories),a(),r("ngForOf",o.getSubCategoryOptions(i.controls.category_id.value))}}function Se(n,c){if(n&1){let i=y();s(0,"tmf-select",15),h(1,ye,1,2,"tmf-option",16),u(),s(2,"tmf-select",17),b("selectChange",function(e){C(i);let t=m(2);return x(t.handleCategoryChange(e))}),h(3,Fe,1,4,"tmf-option",18),u(),s(4,"div",19)(5,"span",20),_(6,"\u6559\u5B78\u5C08\u9577"),u(),s(7,"span",21),_(8,"*\u76E1\u53EF\u80FD\u9078\u64C7\u71B1\u9580\u5C08\u9577\uFF0C\u4EE5\u7372\u5F97\u66F4\u591A\u62DB\u751F\u6A5F\u6703(3\u9805/\u79D1\u76EE)\u3002"),u()(),h(9,we,3,6,"ng-container",22),s(10,"tmf-quill-editor",23),b("contentChangeEvent",function(e){C(i);let t=m(2);return x(t.introduceControl.setValue(e))}),u()}if(n&2){let i=m(2);r("isRequired",!0)("multiSelect",!1),a(),r("ngForOf",i.nationOptions),a(),r("formControl",i.topicControl)("isRequired",!0)("multiSelect",!0)("maxSelected",3),a(),r("ngForOf",i.tagOptions),a(6),r("ngForOf",i.categoriesFormArray.controls),a(),r("isRequired",!0)("diabled",i.introduceControl.disabled)("defaultContent",i.introduceControl.value||"")}}function ke(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function Ee(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function Ie(n,c){n&1&&(s(0,"span",31),_(1,"*"),u())}function Oe(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function Ve(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function Pe(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function De(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function Me(n,c){if(n&1){let i=y();s(0,"div",26)(1,"div",27)(2,"tmf-checkbox",28),b("checkedChange",function(e){C(i);let t=m(2);return x(t.handleIsInSchoolChange(e))}),u()(),s(3,"div",29)(4,"div",30)(5,"div"),_(6,"\u958B\u59CB\u6642\u9593"),s(7,"span",31),_(8,"*"),u()(),s(9,"div",32)(10,"tmf-select",33),h(11,ke,1,2,"tmf-option",16),u(),s(12,"tmf-select",34),h(13,Ee,1,2,"tmf-option",16),u()()(),s(14,"div",30)(15,"div"),_(16," \u7D50\u675F\u6642\u9593 "),h(17,Ie,2,0,"span",31),u(),s(18,"div",32)(19,"tmf-select",33),h(20,Oe,1,2,"tmf-option",16),u(),s(21,"tmf-select",34),h(22,Ve,1,2,"tmf-option",16),u()()()(),s(23,"tmf-select",35),h(24,Pe,1,2,"tmf-option",16),u(),g(25,"tmf-input",36)(26,"tmf-input",36),s(27,"tmf-select",37),h(28,De,1,2,"tmf-option",16),u(),s(29,"div",38)(30,"span",39),_(31,"\u4E0A\u50B3\u5B78\u4F4D\u8B49\u66F8"),s(32,"span",31),_(33,"*"),u()(),s(34,"input",40,1),b("change",function(e){C(i);let t=m(2);return x(t.handleFileChange(e,t.learning_experience.controls.file,"degree"))}),u(),s(36,"button",41),b("click",function(){C(i);let e=k(35);return x(e.click())}),_(37),u()()()}if(n&2){let i,o,e,t=m(2);r("formGroupName","learning_experience"),a(2),r("formControlName","is_in_school"),a(8),r("multiSelect",!1)("formControlName","start_year"),a(),r("ngForOf",t.yearOptions),a(),r("multiSelect",!1)("formControlName","start_month"),a(),r("ngForOf",t.monthOptions),a(4),T(17,(i=t.learning_experience.get("is_in_school"))!=null&&i.value?-1:17),a(2),r("multiSelect",!1)("formControlName","end_year"),a(),r("ngForOf",t.yearOptions),a(),r("multiSelect",!1)("formControlName","end_month"),a(),r("ngForOf",t.monthOptions),a(),r("isRequired",!0)("multiSelect",!1)("formControlName","region"),a(),r("ngForOf",t.regionOptions),a(),r("label","\u5B78\u6821\u540D\u7A31")("isRequired",!0)("inputType",t.InputType.Outline)("formControlName","name"),a(),r("label","\u79D1\u7CFB\u540D\u7A31")("isRequired",!0)("inputType",t.InputType.Outline)("formControlName","department"),a(),r("isRequired",!0)("multiSelect",!1)("formControlName","degree"),a(),r("ngForOf",t.degreeOptions),a(8),r("disabled",(o=t.learning_experience.get("file"))==null?null:o.disabled),a(),M(" ",(e=t.learning_experience.get("file"))!=null&&e.value?"\u5DF2\u4E0A\u50B3":"\u9078\u64C7\u6A94\u6848"," ")}}function Ne(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function Ae(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function qe(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function $e(n,c){n&1&&(s(0,"span",31),_(1,"*"),u())}function Be(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function Re(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.label)}}function Ge(n,c){if(n&1){let i=y();s(0,"div",43)(1,"div",19)(2,"div",46)(3,"tmf-checkbox",47),b("checkedChange",function(e){let t=C(i).$index,l=m(3);return x(l.handleIsWorkingChange(e,t))}),u(),s(4,"button",48),b("click",function(){let e=C(i).$index,t=m(3);return x(t.removeGroup(t.GroupType.Work_experience,e))}),s(5,"span",49),_(6,"close"),u()()(),g(7,"tmf-input",50)(8,"tmf-input",36),s(9,"tmf-select",51),h(10,Ne,1,2,"tmf-option",16),u(),g(11,"tmf-input",36),s(12,"div",52)(13,"div",30)(14,"div"),_(15,"\u958B\u59CB\u6642\u9593"),s(16,"span",31),_(17,"*"),u()(),s(18,"div",32)(19,"tmf-select",33),h(20,Ae,1,2,"tmf-option",16),u(),s(21,"tmf-select",34),h(22,qe,1,2,"tmf-option",16),u()()(),s(23,"div",30)(24,"div"),_(25," \u7D50\u675F\u6642\u9593 "),h(26,$e,2,0,"span",31),u(),s(27,"div",32)(28,"tmf-select",33),h(29,Be,1,2,"tmf-option",16),u(),s(30,"tmf-select",34),h(31,Re,1,2,"tmf-option",16),u()()()()()()}if(n&2){let i,o=c.$implicit,e=c.$index,t=m(3);r("formGroupName",e),a(4),r("disabled",t.work_experiences.disabled),a(3),r("isRequired",!0)("inputType",t.InputType.Outline)("formControlName","company_name"),a(),r("label","\u5DE5\u4F5C\u5730\u9EDE")("isRequired",!0)("inputType",t.InputType.Outline)("formControlName","workplace"),a(),r("isRequired",!0)("multiSelect",!1)("formControlName","job_category"),a(),r("ngForOf",t.jobCategoryOptions),a(),r("label","\u8077\u4F4D\u540D\u7A31")("isRequired",!0)("inputType",t.InputType.Outline)("formControlName","job_title"),a(8),r("multiSelect",!1)("formControlName","start_year"),a(),r("ngForOf",t.yearOptions),a(),r("multiSelect",!1)("formControlName","start_month"),a(),r("ngForOf",t.monthOptions),a(4),T(26,(i=o.get("is_working"))!=null&&i.value?-1:26),a(2),r("multiSelect",!1)("formControlName","end_year"),a(),r("ngForOf",t.yearOptions),a(),r("multiSelect",!1)("formControlName","end_month"),a(),r("ngForOf",t.monthOptions)}}function We(n,c){if(n&1){let i=y();s(0,"div",42),O(1,Ge,32,30,"div",43,I),s(3,"span",44),b("click",function(){C(i);let e=m(2);return x(e.work_experiences.disabled?null:e.addGroup(e.GroupType.Work_experience))}),s(4,"span",45),_(5,"add"),u(),_(6,"\u65B0\u589E\u5DE5\u4F5C\u7D93\u6B77"),u()()}if(n&2){let i=m(2);a(),V(i.work_experiences.controls),a(2),r("ngClass",N(1,xe,i.work_experiences.disabled))}}function je(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i.value)("label",i.main_category)}}function Le(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i)("label",i)}}function Qe(n,c){if(n&1&&(s(0,"tmf-select",56),h(1,Le,1,2,"tmf-option",16),u()),n&2){let i,o=m().index,e=m(4);r("multiSelect",!1)("formControlName","subject")("isRequired",!0),a(),r("ngForOf",e.getSubCategoryOptions((i=e.teaching_certificates.controls[o].get("category_id"))==null?null:i.value))}}function Ue(n,c){if(n&1){let i=y();P(0),s(1,"div",43)(2,"div",38)(3,"div",54)(4,"button",48),b("click",function(){let e=C(i).index,t=m(4);return x(t.removeGroup(t.GroupType.Teaching_certificate,e))}),s(5,"span",49),_(6,"close"),u()()(),s(7,"tmf-select",55),h(8,je,1,2,"tmf-option",16),u(),h(9,Qe,2,4,"tmf-select",56),g(10,"tmf-input",36)(11,"tmf-input",36)(12,"tmf-input",36)(13,"tmf-input",36),s(14,"div",38)(15,"span",39),_(16,"\u4E0A\u50B3\u8B49\u7167"),s(17,"span",31),_(18,"*"),u()(),s(19,"input",40,2),b("change",function(e){let t=C(i).$implicit,l=m(4);return x(l.handleFileChange(e,t.controls.file,"certificate"))}),u(),s(21,"button",57),b("click",function(){C(i);let e=k(20);return x(e.click())}),_(22),u()()()(),D()}if(n&2){let i,o,e,t=c.$implicit,l=c.index,d=m(4);a(),r("formGroupName",l),a(3),r("disabled",d.teaching_certificates.disabled),a(3),r("multiSelect",!1)("formControlName","category_id")("isRequired",!0),a(),r("ngForOf",d.tagOptions),a(),T(9,(i=d.teaching_certificates.controls[l].get("category_id"))!=null&&i.value?9:-1),a(),r("label","\u8A8D\u8B49\u6A5F\u69CB")("isRequired",!0)("inputType",d.InputType.Outline)("formControlName","verifying_institution"),a(),r("label","\u8B49\u7167\u540D\u7A31")("isRequired",!0)("inputType",d.InputType.Outline)("formControlName","license_name"),a(),r("label","\u8B49\u7167\u7533\u8ACB\u59D3\u540D")("isRequired",!0)("inputType",d.InputType.Outline)("formControlName","name"),a(),r("label","\u8B49\u7167\u5E8F\u865F(\u9650\u8F38\u5165\u82F1\u6578)")("isRequired",!0)("inputType",d.InputType.Outline)("formControlName","license_number"),a(8),r("disabled",(o=t.get("file"))==null?null:o.disabled),a(),M(" ",(e=t.get("file"))!=null&&e.value?"\u5DF2\u4E0A\u50B3":"\u9078\u64C7\u6A94\u6848"," ")}}function Ye(n,c){if(n&1&&(s(0,"div",53),h(1,Ue,23,25,"ng-container",22),u()),n&2){let i=m(3);a(),r("ngForOf",i.teaching_certificates.controls)}}function ze(n,c){if(n&1){let i=y();h(0,Ye,2,1,"div",53),s(1,"span",44),b("click",function(){C(i);let e=m(2);return x(e.teaching_certificates.disabled?null:e.addGroup(e.GroupType.Teaching_certificate))}),s(2,"span",45),_(3,"add"),u(),_(4,"\u65B0\u589E\u6559\u5B78\u8B49\u7167"),u()}if(n&2){let i=m(2);T(0,i.teaching_certificates.controls.length>0?0:-1),a(),r("ngClass",N(2,xe,i.teaching_certificates.disabled))}}function Je(n,c){if(n&1&&g(0,"tmf-option",24),n&2){let i=c.$implicit;r("value",i._id)("label",i.name)}}function He(n,c){if(n&1&&(s(0,"tmf-select",58),h(1,Je,1,2,"tmf-option",16),u()),n&2){let i=m(2);r("isRequired",!0)("multiSelect",!0)("formControl",i.videoControl),a(),r("ngForOf",i.videoList)}}function Ke(n,c){if(n&1){let i=y();s(0,"cdk-accordion-item",5,0)(2,"div",6),b("click",function(){C(i);let e=k(1);return x(e.toggle())}),s(3,"div",7)(4,"p"),_(5),u(),h(6,be,4,0)(7,ve,4,0),u(),s(8,"span",8),_(9," keyboard_arrow_down "),u()(),s(10,"div",9)(11,"div",10),h(12,Se,11,12)(13,Me,38,33)(14,We,7,3)(15,ze,5,4)(16,He,2,4),u()()()}if(n&2){let i,o=c.$implicit,e=k(1),t=m();a(5),L(o.title),a(),T(6,o.isEditMode?6:7),a(2),S("rotate-180",e.expanded),a(2),S("closed",!e.expanded),a(2),T(12,(i=o.id)===t.GroupType.Info?12:i===t.GroupType.Learning_experience?13:i===t.GroupType.Work_experience?14:i===t.GroupType.Teaching_certificate?15:i===t.GroupType.Video?16:-1)}}var ft=(()=>{let c=class c{constructor(){this.fb=F(ie),this.teacherFormService=F(Ce),this.commonService=F(ue),this.teacherInfoService=F(me),this.teacherVideoService=F(de),this.uploadService=F(_e),this.dialogService=F(pe),this.items=[{id:p.Info,title:"\u57FA\u672C\u8CC7\u6599",isEditMode:!1},{id:p.Learning_experience,title:"\u5B78\u6B77\u80CC\u666F",isEditMode:!1},{id:p.Work_experience,title:"\u5DE5\u4F5C\u7D93\u6B77",isEditMode:!1},{id:p.Teaching_certificate,title:"\u6559\u5B78\u8B49\u7167",isEditMode:!1},{id:p.Video,title:"\u81EA\u4ECB\u5F71\u7247",isEditMode:!1}],this.tagOptions=[],this.nationOptions=[],this.jobCategoryOptions=[],this.yearOptions=[],this.monthOptions=[],this.degreeOptions=[],this.regionOptions=[{label:"\u53F0\u7063",value:!0},{label:"\u6D77\u5916",value:!1}],this.videoList=[],this.uploadQueue=[],this.topicControl=this.fb.control([]),this.videoControl=this.fb.control([]),this.formControlMap={[p.All]:[],[p.Info]:["categories","nationality","introduction"],[p.Learning_experience]:["learning_experience"],[p.Work_experience]:["work_experiences"],[p.Teaching_certificate]:["teaching_certificates"],[p.Video]:[]},this.GroupType=p,this.InputType=oe}get introduceControl(){return this.teacherForm.controls.introduction}get categoriesFormArray(){return this.teacherForm.controls.categories}get work_experiences(){return this.teacherForm.get("work_experiences")}get learning_experience(){return this.teacherForm.get("learning_experience")}get teaching_certificates(){return this.teacherForm.get("teaching_certificates")}ngOnInit(){this.teacherForm=this.teacherFormService.createTeacherForm("info"),this.initData(),this.getOptions()}initData(){this.updateData(p.All),this.teacherVideoService.apiTeacherVideoGet().subscribe(o=>{this.videoList=o.data})}updateData(o){this.teacherInfoService.apiTeacherInfoGet().subscribe(e=>{switch(this.defaultData=e.data,o){case p.All:{this.topicControl.setValue(e.data.categories.map(t=>t.category_id)||[]),this.handleCategoryChange(this.topicControl.value||[]),this.formControlMap[p.Info].forEach(t=>{this.teacherForm.get(t)?.reset(this.defaultData[t])}),this.topicControl.disable(),this.learning_experience.patchValue(this.defaultData.learning_experience),this.learning_experience.disable(),this.work_experiences.clear(),this.defaultData.work_experiences.forEach(()=>{this.addGroup(p.Work_experience)}),this.work_experiences.patchValue(this.defaultData.work_experiences),this.work_experiences.disable(),this.teaching_certificates.clear(),this.defaultData.teaching_certificates.forEach(()=>{this.addGroup(p.Teaching_certificate)}),this.teaching_certificates.patchValue(this.defaultData.teaching_certificates),this.teaching_certificates.disable(),this.videoControl.setValue(e.data.intro_video.map(t=>t.video_id)||[]),this.videoControl.disable(),this.teacherForm.disable();break}case p.Info:{this.topicControl.setValue(e.data.categories.map(t=>t.category_id)||[]),this.handleCategoryChange(this.topicControl.value||[]),this.formControlMap[p.Info].forEach(t=>{this.teacherForm.get(t)?.reset(this.defaultData[t])}),this.topicControl.disable(),this.teacherForm.disable();break}case p.Learning_experience:{this.learning_experience.patchValue(this.defaultData.learning_experience),this.learning_experience.disable();break}case p.Work_experience:{this.work_experiences.clear(),this.defaultData.work_experiences.forEach(()=>{this.addGroup(p.Work_experience)}),this.work_experiences.patchValue(this.defaultData.work_experiences),this.work_experiences.disable();break}case p.Teaching_certificate:{this.teaching_certificates.clear(),this.defaultData.teaching_certificates.forEach(()=>{this.addGroup(p.Teaching_certificate)}),this.teaching_certificates.patchValue(this.defaultData.teaching_certificates),this.teaching_certificates.disable();break}case p.Video:this.videoControl.setValue(e.data.intro_video.map(t=>t.video_id)||[]),this.videoControl.disable();break}})}getOptions(){this.commonService.apiCommonTagGet().subscribe(e=>{this.tagOptions=e.data.map(t=>({value:t._id,main_category:t.main_category,sub_category:t.sub_category}))}),this.commonService.apiCommonOptionsNationGet().subscribe(e=>{this.nationOptions=e.data}),this.commonService.apiCommonOptionsJobCategoryGet().subscribe(e=>{this.jobCategoryOptions=e.data});let o=new Date().getFullYear();this.yearOptions=Array.from({length:16},(e,t)=>{let l=o-t;return{label:`${l}`,value:`${l}`}}),this.monthOptions=Array.from({length:12},(e,t)=>{let l=t+1;return{label:`${l}`,value:`${l}`}}),this.commonService.apiCommonOptionsDegreeGet().subscribe(e=>{this.degreeOptions=e.data})}changeMode(o,e){o.isEditMode=e;let t=this.formControlMap[o.id];e||this.reset(o),o.id===p.Info&&this.topicControl?.[o.isEditMode?"enable":"disable"](),o.id===p.Video&&this.videoControl?.[o.isEditMode?"enable":"disable"](),this.toggleFormControls(t,e)}toggleFormControls(o,e){o.forEach(t=>{let l=this.teacherForm.get(t);l&&(e?l.enable():l.disable())})}save(o){if(this.checkValid(o)){let e=this.teacherForm.getRawValue();switch(o.id){case p.Info:{this.teacherInfoService.apiTeacherInfoBasicPatch({patchTeacherInfoBasicRequestModel:{nationality:e.nationality,categories:e.categories.map(t=>({category_id:t.category_id,sub_categories:t.sub_categories})),introduction:e.introduction}}).subscribe(()=>{this.changeMode(o,!1),this.updateData(p.Info)});break}case p.Learning_experience:{let t=this.uploadQueue.find(v=>v.type==="degree"),l=e.learning_experience.file,d=()=>this.teacherInfoService.apiTeacherInfoEducationPatch({patchTeacherInfoEducationRequestModel:{is_in_school:e.learning_experience.is_in_school,degree:e.learning_experience.degree,department:e.learning_experience.department,start_year:e.learning_experience.start_year,start_month:e.learning_experience.start_month,end_year:e.learning_experience.is_in_school?null:e.learning_experience.end_year,end_month:e.learning_experience.is_in_school?null:e.learning_experience.end_month,name:e.learning_experience.name,region:e.learning_experience.region,file:this.learning_experience.controls.file.value||""}}),f;t?f=this.getUploadFile$(t,l).pipe(E(v=>d())):f=d(),f.subscribe({next:()=>{this.changeMode(o,!1),this.updateData(p.Learning_experience),this.uploadQueue=this.uploadQueue.filter(v=>v.type!=="degree")},error:()=>{this.dialogService.openAlertDialog({title:"\u932F\u8AA4",content:"\u66F4\u65B0\u5B78\u6B77\u5931\u6557"})}});break}case p.Work_experience:{this.teacherInfoService.apiTeacherInfoWorkPatch({patchTeacherInfoWorkRequestModelInner:e.work_experiences.map(l=>q(A({_id:l._id||null,company_name:l.company_name,workplace:l.workplace,job_title:l.job_title,job_category:l.job_category,start_year:l.start_year,start_month:l.start_month},l.is_working?{}:{end_year:l.end_year,end_month:l.end_month}),{is_working:l.is_working}))}).subscribe(()=>{this.changeMode(o,!1),this.updateData(p.Work_experience)});break}case p.Teaching_certificate:{let t=this.uploadQueue.filter(f=>f.type==="certificate").map(f=>{let v=f.control.value||null;return this.getUploadFile$(f,v)}),l=()=>this.teacherInfoService.apiTeacherInfoCertificatePatch({patchTeacherInfoCertificateRequestModelInner:e.teaching_certificates.map((f,v)=>({_id:f._id||null,name:f.name,file:this.teaching_certificates.controls[v].controls.file.value,category_id:f.category_id,license_name:f.license_name,license_number:f.license_number,subject:f.subject,verifying_institution:f.verifying_institution}))}),d;t.length?d=B(t).pipe(E(()=>l())):d=l(),d.subscribe({next:()=>{this.changeMode(o,!1),this.updateData(p.Teaching_certificate),this.uploadQueue=this.uploadQueue.filter(f=>f.type!=="certificate")},error:()=>{this.dialogService.openAlertDialog({title:"\u932F\u8AA4",content:"\u66F4\u65B0\u6559\u5B78\u8B49\u7167\u5931\u6557"})}});break}case p.Video:{let t=this.videoControl.value;if(!t)return;this.teacherInfoService.apiTeacherInfoVideoPatch({patchTeacherInfoVideoRequestModelInner:t.map(l=>{let d=this.videoList.find(f=>f._id===l);return{video_id:d?._id,title:d?.name}})}).subscribe(()=>{this.changeMode(o,!1),this.updateData(p.Video)});break}}}else this.dialogService.openAlertDialog({title:"\u932F\u8AA4",content:"\u8ACB\u586B\u5BEB\u5B8C\u6574\u8CC7\u6599!"})}getUploadFile$(o,e){let t;return e&&e!=="hasFile"?t=this.uploadService.apiUploadFileDelete({deleteRequestModel:{fileUrl:e}}).pipe(E(()=>this.uploadService.apiUploadFilePost({fileType:"file",path:o.type,file:o.file}))):t=this.uploadService.apiUploadFilePost({fileType:"file",path:o.type,file:o.file}),t.pipe(G(()=>(this.dialogService.openAlertDialog({title:"\u932F\u8AA4",content:"\u6A94\u6848\u4E0A\u50B3\u5931\u6557!"}),$)),W(l=>o.control.setValue(l.fileUrl||"")))}checkValid(o){switch(o.id){case p.Info:return this.formControlMap[p.Info].every(e=>this.teacherForm.get(e)?.valid??!1)&&this.topicControl.valid;case p.Learning_experience:return this.learning_experience?.valid;case p.Work_experience:return this.work_experiences.valid;case p.Teaching_certificate:return this.teaching_certificates.valid;default:return!0}}reset(o){switch(o.id){case p.Info:this.topicControl.setValue(this.defaultData.categories.map(e=>e.category_id)||[]),this.handleCategoryChange(this.topicControl.value||[]),this.formControlMap[p.Info].forEach(e=>{this.teacherForm.get(e)?.reset(this.defaultData[e])});break;case p.Learning_experience:this.learning_experience?.patchValue(this.defaultData.learning_experience);break;case p.Work_experience:this.work_experiences.clear(),this.defaultData.work_experiences.forEach(()=>{this.addGroup(p.Work_experience)}),this.work_experiences.patchValue(this.defaultData.work_experiences);break;case p.Teaching_certificate:this.teaching_certificates.clear(),this.defaultData.teaching_certificates.forEach(()=>{this.addGroup(p.Teaching_certificate)}),this.teaching_certificates.patchValue(this.defaultData.teaching_certificates);break}}addGroup(o){switch(o){case p.Work_experience:this.work_experiences.push(this.teacherFormService.createWorkExperience("info"));break;case p.Teaching_certificate:this.teaching_certificates.push(this.teacherFormService.createTeachingCertificate("info"));break}}removeGroup(o,e){this.dialogService.openConfirmDialog({title:"\u522A\u9664\u78BA\u8A8D",content:`\u78BA\u5B9A\u8981\u522A\u9664\u6B64${o===p.Work_experience?"\u5DE5\u4F5C\u7D93\u6B77":"\u6559\u5B78\u8B49\u7167"}\u55CE?`}).pipe(R(t=>t)).subscribe(()=>{switch(o){case p.Work_experience:this.work_experiences.removeAt(e);break;case p.Teaching_certificate:this.teaching_certificates.removeAt(e);break}})}getCategoryLabel(o){return this.tagOptions.find(t=>t.value===o)?.main_category||""}getSubCategoryOptions(o){return this.tagOptions.find(t=>t.value===o)?.sub_category||[]}handleCategoryChange(o){let e=this.teacherForm.controls.categories,t=new Set(o);for(let l=e.controls.length-1;l>=0;l--){let d=e.controls[l];t.has(d.controls.category_id.value)||e.removeAt(l)}o.forEach(l=>{if(!e.controls.some(f=>f.controls.category_id.value===l)){let f=this.items.find(v=>v.id===p.Info);e.push(this.fb.group({category_id:this.fb.control(l,[w.required]),sub_categories:this.fb.control({value:[],disabled:!f?.isEditMode},[w.required])}))}})}handleIsInSchoolChange(o){let e=this.learning_experience,t=e.get("end_year"),l=e.get("end_month");o?(t?.reset(),l?.reset(),t?.disable(),l?.disable(),t?.setValidators(null),l?.setValidators(null)):(t?.enable(),l?.enable(),t?.setValidators([w.required]),l?.setValidators([w.required])),t?.updateValueAndValidity()}handleIsWorkingChange(o,e){let t=this.work_experiences.controls[e],l=t.get("end_year"),d=t.get("end_month");o?(l?.reset(),d?.reset(),l?.disable(),d?.disable(),l?.setValidators(null),d?.setValidators(null)):(l?.enable(),d?.enable(),l?.setValidators([w.required]),d?.setValidators([w.required])),l?.updateValueAndValidity()}handleFileChange(o,e,t){let d=o.target.files?.[0];if(!d)return;e.setValue(e.value||"hasFile");let f=this.uploadQueue.find(v=>v.control===e);f?f.file=d:this.uploadQueue.push({file:d,type:t,control:e})}};c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=j({type:c,selectors:[["app-teacher-info-page"]],standalone:!0,features:[Q],decls:5,vars:1,consts:[["accordionItem","cdkAccordionItem"],["learningExperienceFile",""],["certificateFile",""],[1,"mb-6","text-3xl","font-bold","text-tmf-gray-1"],[1,"accordion",3,"formGroup"],[1,"accordion-item"],[1,"accordion-item-header",3,"click"],[1,"flex","items-center","gap-2"],[1,"material-symbols-outlined","duration-75"],[1,"accordion-item-body"],[1,"accordion-item-content"],[1,"rounded-md","bg-tmf-gray-3","px-2","py-1","text-sm","text-white",3,"click"],[1,"rounded-md","bg-tmf-orange-1","px-2","py-1","text-sm","text-white",3,"click"],[1,"flex","items-center","gap-2","rounded-md","bg-tmf-orange-1","px-2","py-1","text-sm","text-white",3,"click"],[1,"material-symbols-outlined","text-sm"],["label","\u570B\u5BB6","formControlName","nationality",1,"bg-white","text-gray-700",3,"isRequired","multiSelect"],[3,"value","label",4,"ngFor","ngForOf"],["label","\u6559\u6388\u79D1\u76EE","info","*\u60A8\u6700\u591A\u53EA\u80FD\u6559\u6388\u4E09\u7A2E\u79D1\u76EE",1,"bg-white","text-gray-700",3,"selectChange","formControl","isRequired","multiSelect","maxSelected"],[3,"selected","value","label",4,"ngFor","ngForOf"],[1,"flex","flex-col"],[1,"mb-1","ml-1","inline-block","text-sm","font-medium","text-tmf-gray-2","md:text-[15px]","md:leading-6"],[1,"mb-2","ml-1","text-sm","text-gray-500"],[4,"ngFor","ngForOf"],["label","\u81EA\u6211\u4ECB\u7D39","height","400px",1,"mb-6",3,"contentChangeEvent","isRequired","diabled","defaultContent"],[3,"value","label"],[1,"bg-white","text-gray-700",3,"label","multiSelect","maxSelected","isRequired","formControl"],[3,"formGroupName"],[1,"mb-6","flex"],["label","\u6211\u662F\u5728\u6821\u751F\uFF0C\u76EE\u524D\u5C31\u8B80\u4E2D","direct","horizontal",3,"checkedChange","formControlName"],[1,"mb-6","flex","flex-col","justify-between","gap-6","md:flex-row"],[1,"flex","flex-1","flex-col","gap-2"],[1,"text-red-500"],[1,"flex","flex-col","justify-between","gap-4","md:flex-row"],["placeholder","\u5E74\u4EFD",1,"bg-white","text-gray-700",3,"multiSelect","formControlName"],["placeholder","\u6708\u4EFD",1,"bg-white","text-gray-700",3,"multiSelect","formControlName"],["label","\u5730\u9EDE",1,"mb-6","bg-white","text-gray-700",3,"isRequired","multiSelect","formControlName"],[1,"w-full",3,"label","isRequired","inputType","formControlName"],["label","\u5B78\u4F4D",1,"mb-6","bg-white","text-gray-700",3,"isRequired","multiSelect","formControlName"],[1,"flex","flex-col","gap-2"],[1,"inline-block","text-sm","font-medium","text-tmf-gray-2","md:text-[15px]","md:leading-6"],["type","file","hidden","",3,"change"],["type","button",1,"shadow-white-1/10","hover:shadow-white-1/20","select-none","rounded-lg","border","bg-white","px-6","py-3","text-center","align-middle","font-sans","text-xs","font-bold","uppercase","text-black","shadow-md","transition-all","hover:shadow-lg","focus:opacity-[0.85]","focus:shadow-none","active:opacity-[0.85]","active:shadow-none","disabled:cursor-not-allowed","disabled:opacity-50","disabled:shadow-none",3,"click","disabled"],["formArrayName","work_experiences",1,"flex","flex-col","gap-y-5"],[1,"rounded-lg","border","p-4",3,"formGroupName"],[1,"flex","cursor-pointer","items-center","text-tmf-orange-1",3,"click","ngClass"],[1,"material-icons-outlined"],[1,"mb-6","flex","justify-between"],["formControlName","is_working","label","\u662F\u5426\u5728\u8077\u4E2D","direct","horizontal",3,"checkedChange"],[1,"h-6","w-6","rounded-full","bg-red-500","hover:bg-red-700","disabled:cursor-not-allowed","disabled:bg-tmf-gray-2",3,"click","disabled"],[1,"material-icons-outlined","text-white"],["label","\u516C\u53F8\u540D\u7A31",1,"w-full",3,"isRequired","inputType","formControlName"],["label","\u8077\u52D9\u985E\u5225",1,"mb-6","bg-white","text-gray-700",3,"isRequired","multiSelect","formControlName"],[1,"flex","flex-col","justify-between","gap-3","md:flex-row"],["formArrayName","teaching_certificates",1,"flex","flex-col","gap-y-5"],[1,"flex","justify-end"],["label","\u8B49\u7167\u79D1\u76EE",1,"mb-6","bg-white","text-gray-700",3,"multiSelect","formControlName","isRequired"],["label","\u8B49\u7167\u985E\u5225",1,"mb-6","bg-white","text-gray-700",3,"multiSelect","formControlName","isRequired"],["type","button",1,"shadow-white-1/10","hover:shadow-white-1/20","select-none","rounded-lg","border","bg-white","px-6","py-3","text-center","align-middle","font-sans","text-xs","font-bold","uppercase","text-black","shadow-md","transition-all","hover:shadow-lg","focus:opacity-[0.85]","focus:shadow-none","active:opacity-[0.85]","active:shadow-none","disabled:pointer-events-none","disabled:opacity-50","disabled:shadow-none",3,"click","disabled"],["label","\u5F71\u7247",1,"mb-6","bg-white","text-gray-700",3,"isRequired","multiSelect","formControl"]],template:function(e,t){e&1&&(s(0,"h1",3),_(1,"\u6559\u5E2B\u8CC7\u8A0A\u7BA1\u7406"),u(),s(2,"cdk-accordion",4),O(3,Ke,17,7,"cdk-accordion-item",5,I),u()),e&2&&(a(2),r("formGroup",t.teacherForm),a(),V(t.items))},dependencies:[ge,fe,he,ne,J,H,K,X,te,Z,ee,z,U,Y,ce,le,se,re,ae],styles:[".accordion[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:.75rem}.accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]{border-radius:.375rem;border-width:1px;padding:.5rem;--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]   .accordion-item-header[_ngcontent-%COMP%]{display:flex;width:100%;cursor:pointer;align-items:center;justify-content:space-between}.accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]   .accordion-item-body[_ngcontent-%COMP%]{margin-top:.5rem;display:grid;grid-template-columns:100%;grid-template-rows:1fr;border-radius:.375rem;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity));transition-duration:.1s}.accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]   .accordion-item-body.closed[_ngcontent-%COMP%]{margin-top:0;grid-template-rows:0fr;border-width:0px}.accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]   .accordion-item-body.closed[_ngcontent-%COMP%]   .accordion-item-content[_ngcontent-%COMP%]{visibility:hidden;padding-top:0;padding-bottom:0}.accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]   .accordion-item-body[_ngcontent-%COMP%]   .accordion-item-content[_ngcontent-%COMP%]{visibility:visible;display:flex;min-height:0px;flex-direction:column;gap:1.25rem;overflow:hidden;padding:1rem .5rem .5rem;transition-duration:.2s}"]});let n=c;return n})();export{ft as default};
